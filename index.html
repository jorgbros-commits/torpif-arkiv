// --- Navn-aliaser (konkrete unntak) ---
const NAME_ALIASES = {
  "andreas brynjeng sandvik": "Andreas Sandvik",
  "carl viktor mikael tillberg": "Viktor Tillberg",
  "victor tilberg": "Viktor Tillberg",
  "viktor tilberg": "Viktor Tillberg",
  "jon morten skogsrud": "Jon Morten Skåksrud",
  "jon morten skåksrud": "Jon Morten Skåksrud",
  "geir kalrsen": "Geir Karlsen",
  "geir karslen": "Geir Karlsen"
  // legg gjerne flere etter behov
};

// --- Lett normalisering uten biblioteker ---
function canonicalizeName(raw){
  if(!raw) return "";

  // 1) Normalize/trim
  let s = String(raw)
    .normalize("NFD").replace(/[\u0300-\u036f]/g,"")  // fjerner aksenter (å->a, ø->o, æ->ae)
    .replace(/\s+/g," ")                               // flere spaces -> ett
    .trim();

  // 2) Alias (full match) – tar de kjente duplikatene først
  const aliasHit = NAME_ALIASES[s.toLowerCase()];
  if (aliasHit) return toTitleCase(aliasHit);

  // 3) Del i ord og fjern mellomnavn (behold første + siste)
  const parts = s.split(" ").filter(Boolean);
  if (parts.length >= 2) {
    let first = parts[0];
    let last  = parts[parts.length - 1];

    // 4) Standardiser fornavn: Victor -> Viktor
    if (/^victor$/i.test(first)) first = "Viktor";

    // 5) Rydd opp i etternavn: Til(l)berg-varianter -> Tillberg
    const lastPlain = last.toLowerCase().replace(/[^a-z]/g,"");
    if (/^ti+l+ber?g$/.test(lastPlain)) {
      last = "Tillberg";
    }

    return toTitleCase(`${first} ${last}`);
  }

  // Fallback: tittel-case på enkeltord
  return toTitleCase(s);
}

function toTitleCase(name){
  return name.toLowerCase().replace(/\b\w/g, c => c.toUpperCase());
}
